#!/data/data/com.termux/files/usr/bin/bash

# 1. Cài các gói cần thiết
pkg update -y
pkg install -y zsh git curl fzf

# 2. Cài Oh My Zsh nếu chưa có
if [ ! -d "$HOME/.oh-my-zsh" ]; then
    export RUNZSH=no
    export CHSH=no
    sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
fi

# 3. Cài zsh-autosuggestions
ZSH_CUSTOM=${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}
if [ ! -d "$ZSH_CUSTOM/plugins/zsh-autosuggestions" ]; then
    git clone https://github.com/zsh-users/zsh-autosuggestions "$ZSH_CUSTOM/plugins/zsh-autosuggestions"
fi

# 4. Cập nhật ~/.zshrc
echo "Cập nhật plugins trong ~/.zshrc..."
sed -i 's/^plugins=(.*)$/plugins=(git z zsh-autosuggestions fzf python docker laravel emoji)/' ~/.zshrc || \
echo "plugins=(git z zsh-autosuggestions fzf python docker laravel emoji)" >> ~/.zshrc

# 5. Đặt zsh làm shell mặc định (chỉ khi script chạy trong Termux login shell)
termux-change-shell zsh

echo "✅ Hoàn tất! Mở terminal mới hoặc chạy: source ~/.zshrc"
source ~/.zshrc
